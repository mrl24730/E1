window.ModelNum="";var errorMsgs={ModelNum:{en:{m1:"Please enter Model No.",m2:"Please enter a valid Model No."},tc:{m1:"請輸入型號",m2:"請輸入有效的型號"},sc:{m1:"请输入型号",m2:"请输入有效的型号"},fr:{m1:"S'il vous plaît entrée Modèle No.",m2:"Veuillez saisir un modèle valable No."}},CaseNum:{en:{m2:"Please enter a valid Case No."},tc:{m2:"請輸入有效的表殼編號"},sc:{m2:"请输入有效的表壳编号"},fr:{m2:"veuillez saisir une montre nombre de cas valide"}},WarrantyNum:{en:{m1:"please enter warranty number",m2:"please enter a valid warranty number"},tc:{m1:"請輸入保修號碼",m2:"請輸入有效的保修號碼"},sc:{m1:"请输入保修号码",m2:"请输入一个有效的保修号码"},fr:{m1:"s'il vous plaît le numéro de garantie d'entrée",m2:"s'il vous plaît entrer un numéro de garantie valide"}},Name:{en:{m1:"please enter name"},tc:{m1:"請輸入名字"},sc:{m1:"请输入名字"},fr:{m1:"s'il vous plaît nom de l'entrée"}},Title:{en:{m1:"please select title"},tc:{m1:"請選擇尊稱"},sc:{m1:"请选择尊称"},fr:{m1:"s'il vous plaît sélectionner le titre"}},Email:{en:{m2:"please enter a valid email address"},tc:{m2:"請輸入有效的電郵地址"},sc:{m2:"请输入有效的电邮地址"},fr:{m2:"s'il vous plaît entrée Une adresse email valide"}},Phone:{en:{m1:"please enter phone number",m2:"please enter a valid phone number"},tc:{m1:"請輸入電話號碼",m2:"請輸入一個有效的電話號碼"},sc:{m1:"请输入电话号码",m2:"请输入一个有效的电话号码"},fr:{m1:"s'il vous plaît le numéro de téléphone d'entrée",m2:"s'il vous plaît entrer un numéro de téléphone valide"}},Dop:{en:{m1:"please select date of purchase",m2:"please select a valid date of purchase"},tc:{m1:"請選擇購買日期",m2:"請選擇有效的購買日期"},sc:{m1:"请选择购买日期",m2:"请选择有效的购买日期"},fr:{m1:"s'il vous plaît choisir la date d'achat",m2:"s'il vous plaît choisir une date d'achat valide"}},InvNum:{en:{m1:"please enter invoice number"},tc:{m1:"請輸入發票號碼"},sc:{m1:"请输入发票号码"},fr:{m1:"s'il vous plaît entrer le numéro de la facture"}},Country:{en:{m1:"please select country"},tc:{m1:"請選擇國家"},sc:{m1:"请选择国家"},fr:{m1:"s'il vous plaît sélectionner le pays"}},City:{en:{m1:"please select city"},tc:{m1:"請選擇城市"},sc:{m1:"请选择城市"},fr:{m1:"s'il vous plaît sélectionner la ville"}},Captcha:{en:{m1:"please enter captcha",m2:"please enter a valid captcha"},tc:{m1:"請輸入驗證碼",m2:"請輸入有效的驗證碼"},sc:{m1:"请输入验证码",m2:"请输入有效的验证码"},fr:{m1:"s'il vous plaît entrer captcha",m2:"s'il vous plaît entrer un captcha valide"}}};
$(document).ready(function(){initWarranty();});function initWarranty(){$("body").addClass("isWarranty");ModelNumAjax();initCountryCity();$(".radio-Gp").each(function(){var a=this;
$(this).find("a").click(function(){$(a).find("a").removeClass("selected");$(this).addClass("selected");$("#"+$(a).data("input")).val($(this).data("val"));
});});$("#Dop").datepicker({dateFormat:"yy-mm-dd",maxDate:0});$("#ui-datepicker-div").wrap('<div class="eb-jqui"></div>');formSubmission();}function initCountryCity(){var b={};
for(var c=0;c<countryCityList.length;c++){var d=countryCityList[c];if(b[d.CountryVal]==undefined){b[d.CountryVal]={id:c,txt:d.Country,city:new Array()};
}b[d.CountryVal].city.push({val:d.CityVal,txt:d.City});}$("select#Country").empty();var f="";$.each(b,function(g,i){var h=$("<option/>");h.val(g).text(i.txt);
h.data("city",i.city);$("select#Country").append(h);if(f==""){f=g;}});$(".select2").select2({allowClear:true,minimumResultsForSearch:-1});$("select#Country").on("change",function(h){var g=$(h.added.element[0]).data("city");
a(g);});var e=$("select#Country option:selected").data("city");a(e);function a(g){$("select#City").empty();$.each(g,function(h,j){var i=$("<option/>");
i.val(j.val).text(j.txt);$("select#City").append(i);});$("select#City").trigger("change");}}function ModelNumAjax(){$("#ModelNum").on("blur",function(){if($.trim($(this).val())!=""){var a={};
window.ModelNum=$(this).val();a.ModelNum=window.ModelNum;$.ajax({type:"POST",url:"/api/getWarrantyModel.ashx",data:a}).success(function(b){var c=$(".model_preview img");
if(b.status===1){if(b.data.Src!=null){c.prop("src",b.data.Src);c.error(function(){c.prop("src","/images/watches/noimage_s.png");c.unbind("error");});c.load(function(){c.unbind("error, load");
});}else{c.prop("src","/images/watches/noimage_s.png");}$("#ModelNum").data("valid",true);}else{c.prop("src","/images/watches/noimage_s.png");$("#ModelNum").data("valid",false);
}});}});}function formSubmission(){var b=false;$("#btnNext").click(function(){var e=true;if(d()){c($("#ModelNum"),$("#ModelNum").val());c($("#CaseNum"),$("#CaseNum").val());
c($("#WarrantyNum"),$("#WarrantyNum").val());c($("#Name"),$("#Title").val()+"."+$("#Name").val());c($("#Phone"),$("#Ccode").val()+" "+$("#Phone").val());
c($("#Email"),$("#Email").val());c($("#Dop"),$("#Dop").val());c($("#InvNum"),$("#InvNum").val());c($("#Country"),$("#Country").val());c($("#City"),$("#City").val());
c($("#Captcha"),$("#Captcha").val());$("#warrantyForm-wrapper").addClass("isConfirm");b=true;$("#step1").hide();$("#step2").show();}else{}});$("#btnReset").click(function(){if(b){$("#warrantyForm-wrapper").removeClass("isConfirm");
}else{$("#warrantyForm-wrapper").find("td input").val("");$(".radio-Gp a").removeClass("selected");}});$("#btnBack").click(function(){if(b){$("#warrantyForm-wrapper").removeClass("isConfirm");
b=false;}});$("#warrantyForm").submit(function(g){var f=$(this).serializeArray();$.ajax({type:"POST",url:"/api/warrantyRegistration.ashx",data:f}).success(function(e){if(e.status==1){$("#warrantyForm-wrapper").hide();
$("#succcess-submission").show();}else{$("#btnBack").trigger("click");if(e.message!=""){alert(e.message);}else{var h=$("html").prop("lang");$.each(e.data,function(i,j){a($("#"+i),errorMsgs[i][h][j]);
if(i=="Captcha"){$("#CaptchaImg").prop("src","/api/getCaptchaImg.ashx?r="+(Math.random()*1000000));$("#Captcha").val("");}});}}});g.preventDefault();});
function d(){$(".errorMsg").text("");isValid=true;var g=$("html").prop("lang");var o=$.trim($("#ModelNum").val());var n=$.trim($("#WarrantyNum").val());
var f=$.trim($("#Name").val());var l=$.trim($("#Title").val());var i=$.trim($("#Phone").val());var j=$.trim($("#Email").val());var h=$.trim($("#Dop").val());
var e=$.trim($("#InvNum").val());var m=$.trim($("#Country").val());var k=$.trim($("#City").val());var q=$.trim($("#Captcha").val());if(o==""){isValid=a($("#ModelNum"),errorMsgs.ModelNum[g]["m1"]);
}else{if(!$("#ModelNum").data("valid")){isValid=a($("#ModelNum"),errorMsgs.ModelNum[g]["m2"]);}}if(n==""){isValid=a($("#WarrantyNum"),errorMsgs.ModelNum[g]["m2"]);
}if(f==""){isValid=a($("#Name"),errorMsgs.ModelNum[g]["m1"]);}if(l==""){isValid=a($("#Title"),errorMsgs.ModelNum[g]["m1"]);}if(i==""){isValid=a($("#Phone"),errorMsgs.Phone[g]["m1"]);
}else{if(!/^(?=.*\d)[\d ]+$/.test(i)){isValid=a($("#Phone"),errorMsgs.Phone[g]["m2"]);}}if(j!=""){var p=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;
if(!p.test(j)){isValid=a($("#Email"),errorMsgs.Email[g]["m2"]);}}if(h==""){isValid=a($("#Dop"),errorMsgs.Dop[g]["m1"]);}if(e==""){isValid=a($("#InvNum"),errorMsgs.InvNum[g]["m1"]);
}if(m==""){isValid=a($("#Country"),errorMsgs.Country[g]["m1"]);}if(k==""){isValid=a($("#City"),errorMsgs.City[g]["m1"]);}if(q==""){isValid=a($("#Captcha"),errorMsgs.Captcha[g]["m1"]);
}return isValid;}function a(h,f){var g=h.parents("td");var e=g.find(".errorMsg");if(e.length==0){e=$("<span/>");e.addClass("errorMsg");g.append(e);}e.text(f);
return false;}function c(h,f){var g=h.parents("td");var e=g.find(".confirmMode");if(e.length==0){e=$("<div/>");e.addClass("confirmMode");g.append(e);}e.text(f==""?"N.A.":f);
}}